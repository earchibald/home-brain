%%{init: {'theme': 'base', 'themeVariables': { 'primaryColor': '#4a90d9', 'primaryTextColor': '#fff', 'lineColor': '#5a6f85'}}}%%
sequenceDiagram
    participant User as ðŸ‘¤ User
    participant Agent as ðŸ¤– SlackAgent
    participant Hooks as âš¡ Hooks
    participant LLM as ðŸ§  LLM
    participant Tools as ðŸ› ï¸ ToolExecutor
    participant Brain as ðŸ“š ChromaDB/Web

    User->>Agent: "Find React hooks info"
    Agent->>Hooks: Pre-process: intent_classifier_hook()
    Hooks-->>Agent: Intent: RESEARCH
    
    Agent->>LLM: Generate (tools available)
    LLM-->>Agent: tool_use: web_search("React hooks")
    
    Agent->>Tools: Execute tool
    Tools->>Brain: Fetch results
    Brain-->>Tools: Snippets + URLs
    Tools->>Tools: Record sources to tracker
    Tools-->>Agent: ToolResult
    
    Agent->>LLM: Tool context + original question
    LLM-->>Agent: Final answer text
    
    Agent->>Hooks: Post-process: citation_hook()
    Hooks->>Hooks: Format citations from tracker
    Hooks-->>Agent: Enhanced response
    
    Agent->>User: Final response with citations
