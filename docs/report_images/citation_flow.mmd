%%{init: {'theme': 'base', 'themeVariables': { 'primaryColor': '#4a90d9', 'primaryTextColor': '#fff', 'lineColor': '#5a6f85'}}}%%
sequenceDiagram
    participant U as ðŸ‘¤ User
    participant A as ðŸ¤– Agent
    participant T as ðŸ“Š Tracker
    participant B as ðŸ“š Brain
    participant W as ðŸŒ Web
    participant H as âœ¨ Hook
    
    U->>A: "What did I write about X?"
    A->>T: set_tracker(SourceTracker())
    A->>B: brain_search("X")
    B->>T: record_source("brain", "notes.md")
    B-->>A: Search results
    A->>W: web_search("X")
    W->>T: record_source("web", "example.com")
    W-->>A: Search results
    A->>A: LLM generates response
    A->>H: citation_hook(response)
    H->>T: get_sources()
    T-->>H: [brain: notes.md, web: example.com]
    H->>H: Format citations
    H-->>A: Response + ðŸ“šðŸ“ŒðŸŒ citations
    A->>T: clear_tracker()
    A-->>U: Final response with sources
